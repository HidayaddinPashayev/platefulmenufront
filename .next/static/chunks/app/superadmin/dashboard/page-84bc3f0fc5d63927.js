(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[344],{3785:function(e,r,t){Promise.resolve().then(t.bind(t,9289))},9289:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return o}});var n=t(7437),a=t(2265),s=t(8734),l=t(2285),i=t(620);let d={restaurant:null,branches:[],loading:!0,error:null};function o(){var e,r;let{user:t}=(0,s.a)(),o=(0,l.h)(),[c,u]=(0,a.useState)(d);return((0,a.useEffect)(()=>{let e=!1,r=async()=>{if(!(null==t?void 0:t.restaurantId)){u({restaurant:null,branches:[],loading:!1,error:"Restaurant assignment missing in token."});return}u(e=>({...e,loading:!0,error:null}));try{let[r,n]=await Promise.all([(0,i.Vz)(o,t.restaurantId),(0,i.Pz)(o,t.restaurantId)]);if(e)return;u({restaurant:r,branches:n,loading:!1,error:null})}catch(r){if(console.error("[SuperadminDashboard] load error",r),e)return;u({restaurant:null,branches:[],loading:!1,error:"Failed to load restaurant information."})}};return(null==t?void 0:t.role)==="ROLE_SUPERADMIN"?r():u(d),()=>{e=!0}},[o,t]),(null==t?void 0:t.role)!=="ROLE_SUPERADMIN")?(0,n.jsx)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 px-6 py-4 text-sm text-amber-900",children:"Access restricted to SuperAdmin role."}):t.restaurantId?(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("header",{className:"page-header",children:[(0,n.jsx)("h1",{className:"page-title",children:"Restaurant overview"}),(0,n.jsx)("p",{className:"page-subtitle",children:"You are managing a single restaurant tenant. All data shown belongs to that restaurant only."})]}),c.error?(0,n.jsx)("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:c.error}):null,c.loading?(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("div",{className:"skeleton h-40 w-full"})}):c.restaurant?(0,n.jsx)("section",{className:"card",children:(0,n.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-6",children:[(0,n.jsxs)("div",{className:"space-y-4 flex-1 min-w-[300px]",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-warm-900",children:c.restaurant.name}),(0,n.jsxs)("dl",{className:"grid gap-4 text-sm text-warm-600 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Owner SuperAdmin ID"}),(0,n.jsx)("dd",{className:"mt-1 text-base text-warm-900 font-medium",children:c.restaurant.ownerSuperAdminId})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Timezone"}),(0,n.jsx)("dd",{className:"mt-1 text-base text-warm-900 font-medium",children:null!==(e=c.restaurant.timezone)&&void 0!==e?e:"—"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Currency"}),(0,n.jsx)("dd",{className:"mt-1 text-base text-warm-900 font-medium",children:null!==(r=c.restaurant.currency)&&void 0!==r?r:"—"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Settings JSON"}),(0,n.jsx)("dd",{className:"mt-1 break-words text-xs text-warm-500 font-mono bg-warm-50 p-2 rounded",children:c.restaurant.settingsJson?c.restaurant.settingsJson.slice(0,120)+(c.restaurant.settingsJson.length>120?"…":""):"—"})]})]})]}),(0,n.jsxs)("div",{className:"rounded-xl border border-warm-200 bg-warm-50 px-6 py-5 text-sm text-warm-600 min-w-[200px]",children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Branches"}),(0,n.jsx)("p",{className:"mt-2 text-4xl font-bold text-primary-600",children:c.branches.length}),(0,n.jsx)("p",{className:"mt-2 text-xs text-warm-500",children:1===c.branches.length?"1 branch linked":"".concat(c.branches.length," branches linked")})]})]})}):(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("p",{className:"text-warm-500",children:"Restaurant information is not available."})})]}):(0,n.jsx)("div",{className:"rounded-xl border border-red-200 bg-red-50 px-6 py-4 text-sm text-red-700",children:"Your JWT is missing the required restaurant identifier. Please contact support."})}},620:function(e,r,t){"use strict";t.d(r,{$6:function(){return u},NA:function(){return c},Pz:function(){return i},Qj:function(){return d},RZ:function(){return f},UL:function(){return w},Vz:function(){return l},aq:function(){return h},jP:function(){return p},o_:function(){return o},uV:function(){return x},zu:function(){return m}});var n=t(533),a=t(2911);let s=e=>encodeURIComponent(e.toLowerCase()),l=async(e,r)=>{if(n.NA)return console.log("[Mock] getRestaurant"),a.Vu;let{data:t}=await e.get("/restaurants/".concat(r));return t},i=async(e,r)=>{if(n.NA)return console.log("[Mock] listBranches"),a.aE.filter(e=>e.restaurantId===r);let{data:t}=await e.get("/restaurants/".concat(r,"/branches"));return null!=t?t:[]},d=async(e,r,t)=>{if(n.NA){var s;console.log("[Mock] createBranch");let e={id:Date.now(),restaurantId:r,name:t.name,adminUserId:null!==(s=t.adminUserId)&&void 0!==s?s:null};return a.aE.push(e),e}let l={name:t.name,restaurantId:r};void 0!==t.adminUserId&&null!==t.adminUserId&&(l.adminUserId=t.adminUserId);let{data:i}=await e.post("/restaurants/".concat(r,"/branches"),l);return i},o=async(e,r,t)=>{if(n.NA){console.log("[Mock] updateBranch");let e=a.aE.find(e=>e.id===r);if(e)return t.name&&(e.name=t.name),void 0!==t.adminUserId&&(e.adminUserId=t.adminUserId),e;throw Error("Branch not found")}let{data:s}=await e.put("/branches/".concat(r),t);return s},c=async(e,r)=>{if(n.NA){console.log("[Mock] deleteBranch");let e=a.aE.findIndex(e=>e.id===r);-1!==e&&a.aE.splice(e,1);return}await e.delete("/branches/".concat(r))},u=async(e,r,t)=>{if(n.NA){console.log("[Mock] assignAdminToBranch");let e=a.aE.find(e=>e.id===r);e&&(e.adminUserId=t);return}await e.post("/branches/".concat(r,"/assign-admin"),{adminUserId:t})},m=async(e,r)=>{if(n.NA)return console.log("[Mock] listAdminsForRestaurant"),a.yv.filter(e=>e.restaurantId===r&&"ROLE_ADMIN"===e.role);let{data:t}=await e.get("/users",{params:{restaurantId:r}});return(null!=t?t:[]).filter(e=>"ROLE_ADMIN"===e.role)},x=async(e,r,t)=>{if(n.NA){var s;console.log("[Mock] createAdmin");let e={id:Date.now(),email:t.email.toLowerCase(),role:"ROLE_ADMIN",restaurantId:r,branchId:null!==(s=t.branchId)&&void 0!==s?s:null,fullName:"New Admin"};return a.yv.push(e),e}let{data:l}=await e.post("/superadmin/users",{email:t.email.toLowerCase(),password:t.password,role:"BRANCH_MANAGER",restaurantId:r,...void 0!==t.branchId&&null!==t.branchId?{branchId:t.branchId}:{}});return l},h=async(e,r,t)=>{if(n.NA){console.log("[Mock] updateAdmin");let e=a.yv.find(e=>e.email.toLowerCase()===r.toLowerCase());if(e)return void 0!==t.branchId&&(e.branchId=t.branchId),e;throw Error("Admin not found")}let{data:l}=await e.patch("/users/".concat(s(r)),{...t.password?{password:t.password}:{},...void 0!==t.branchId?{branchId:t.branchId}:{}});return l},f=async(e,r,t)=>{if(n.NA){var s;console.log("[Mock] resetAdminPassword");let e=a.yv.find(e=>e.id===r);return{status:"success",message:"Password reset successfully (mock)",newPassword:t,adminEmail:null!==(s=null==e?void 0:e.email)&&void 0!==s?s:"admin@mock.com",adminUserId:r}}let{data:l}=await e.post("/superadmin/admins/".concat(r,"/reset-password"),{newPassword:t});return l},p=async(e,r)=>{if(n.NA){console.log("[Mock] deleteAdmin");let e=a.yv.findIndex(e=>e.email.toLowerCase()===r.toLowerCase());-1!==e&&a.yv.splice(e,1);return}await e.delete("/users/".concat(s(r)))},w=async(e,r)=>{if(n.NA)return console.log("[Mock] listRestaurantStaff"),a.yv.filter(e=>e.restaurantId===r&&"ROLE_ADMIN"!==e.role&&"ROLE_SUPERADMIN"!==e.role);let{data:t}=await e.get("/users",{params:{restaurantId:r}});return(null!=t?t:[]).filter(e=>"ROLE_ADMIN"!==e.role)}}},function(e){e.O(0,[301,842,971,117,744],function(){return e(e.s=3785)}),_N_E=e.O()}]);