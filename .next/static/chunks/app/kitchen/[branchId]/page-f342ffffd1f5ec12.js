(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{3092:function(e,t,r){Promise.resolve().then(r.bind(r,2697))},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},257:function(e,t,r){"use strict";var n,s;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,n,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l=[],c=!1,d=-1;function u(){c&&n&&(c=!1,n.length?l=n.concat(l):d=-1,l.length&&h())}function h(){if(!c){var e=i(u);c=!0;for(var t=l.length;t;){for(n=l,l=[];++d<t;)n&&n[d].run();d=-1,t=l.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function b(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new f(e,t)),1!==l.length||c||i(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=b,s.addListener=b,s.once=b,s.off=b,s.removeListener=b,s.removeAllListeners=b,s.emit=b,s.prependListener=b,s.prependOnceListener=b,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var a=r[e]={exports:{}},o=!0;try{t[e](a,a.exports,n),o=!1}finally{o&&delete r[e]}return a.exports}n.ab="//";var s=n(229);e.exports=s}()},2697:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r(7437),s=r(2265),a=r(9376),o=r(533);function i(){let e=(0,a.useParams)(),t=(0,a.useRouter)(),r=Number(e.branchId),[i,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(["","","","","",""]),[u,h]=(0,s.useState)(null),[f,b]=(0,s.useState)(!1),[m,x]=(0,s.useState)(!1),[g,v]=(0,s.useState)(0),p=(0,s.useRef)([]),y=(0,s.useRef)(!1);(0,s.useEffect)(()=>{l(!0),console.log("[KDS] Client-side mounted")},[]);let N=(0,s.useCallback)(e=>{if(!m&&(h(null),c.join("").length<6)){let t=[...c],r=t.findIndex(e=>""===e);-1!==r&&(t[r]=e,d(t),r<5&&v(r+1))}},[c,m]),w=(0,s.useCallback)(()=>{if(m)return;h(null);let e=[...c],t=-1;for(let r=e.length-1;r>=0;r--)if(""!==e[r]){t=r;break}-1!==t&&(e[t]="",d(e),v(t))},[c,m]),j=(0,s.useCallback)((e,t)=>{if(m||(h(null),t.length>1&&(t=t.slice(-1)),""!==t&&!/^\d$/.test(t)))return;let r=[...c];r[e]=t,d(r),t&&e<5&&v(e+1)},[c,m]),k=(0,s.useCallback)((e,t)=>{!m&&("Backspace"===t.key&&""===c[e]&&e>0?v(e-1):"ArrowLeft"===t.key&&e>0?v(e-1):"ArrowRight"===t.key&&e<5&&v(e+1))},[c,m]);(0,s.useEffect)(()=>{if(i&&p.current[g]&&!m){var e;null===(e=p.current[g])||void 0===e||e.focus()}},[g,m,i]);let P=(0,s.useCallback)(async e=>{if(6===e.length&&/^\d{6}$/.test(e)){if(isNaN(r)){h("Invalid branch ID");return}if(!y.current&&!f){y.current=!0,b(!0),h(null);try{console.log("[KDS] Verifying PIN for branch:",r);let t=await fetch("".concat(o.CT,"/branches/").concat(r,"/kitchen/pin/verify"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({pin:e})});if(!t.ok){let e=await t.json().catch(()=>({}));console.error("[KDS] PIN verification failed:",{status:t.status,statusText:t.statusText,errorData:e}),401===t.status?(h("Invalid PIN. Please try again."),d(["","","","","",""]),v(0)):400===t.status?(h("Invalid PIN format. PIN must be 6 digits."),d(["","","","","",""]),v(0)):404===t.status?h("Branch not found."):h("Failed to verify PIN. Please try again."),b(!1),y.current=!1;return}await t.json(),console.log("[KDS] PIN verified successfully"),x(!0),b(!1),y.current=!1}catch(e){console.error("[KDS] PIN verification error:",e),h("Network error. Please check your connection and try again."),b(!1),y.current=!1}}}},[r,f]);(0,s.useEffect)(()=>{if(!i)return;let e=c.join("");6===e.length&&/^\d{6}$/.test(e)&&!y.current&&!f&&!m&&P(e)},[c,f,m,P,i]);let T=(0,s.useCallback)(()=>{t.push("/kitchen/".concat(r,"/orders"))},[r,t]);if(!i)return null;if(isNaN(r))return(0,n.jsx)("main",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 px-4",children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Invalid Branch ID"})})});let I=c.join("");return(0,n.jsx)("main",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-50 via-white to-slate-50 px-4 py-12",children:(0,n.jsxs)("div",{className:"w-full max-w-lg",children:[(0,n.jsxs)("div",{className:"mb-8 text-center",children:[(0,n.jsx)("h1",{className:"mb-2 text-4xl font-extrabold text-gray-900 tracking-tight",children:"Kitchen Display System"}),(0,n.jsx)("div",{className:"mx-auto h-1 w-24 rounded-full bg-blue-600"})]}),(0,n.jsx)("p",{className:"mb-4 text-center text-lg text-gray-700",children:"Enter 6-digit PIN to access kitchen dashboard."}),(0,n.jsxs)("p",{className:"mb-10 text-center text-base font-medium text-gray-600",children:["Branch # ",(0,n.jsx)("span",{className:"font-semibold text-gray-900",children:r})]}),(0,n.jsx)("div",{className:"mb-8 flex justify-center gap-4",children:c.map((e,t)=>(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{ref:e=>{p.current[t]=e},type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>j(t,e.target.value),onKeyDown:e=>k(t,e),onFocus:()=>v(t),disabled:f||m,className:"h-16 w-16 rounded-xl border-3 text-center text-3xl font-bold text-gray-900 shadow-lg transition-all duration-200 ".concat(m?"border-green-500 bg-green-50":e?"border-blue-400 bg-blue-50 shadow-blue-200":"border-gray-300 bg-white"," ").concat(g!==t||m?"":"border-blue-600 ring-4 ring-blue-200 scale-105"," focus:border-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-200 disabled:opacity-70 disabled:cursor-not-allowed")}),m&&e&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("svg",{className:"h-8 w-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]},t))}),m&&(0,n.jsx)("div",{className:"mb-6 animate-in fade-in slide-in-from-top-2 duration-300",children:(0,n.jsx)("div",{className:"rounded-xl bg-green-50 border-2 border-green-500 p-4 text-center",children:(0,n.jsx)("p",{className:"text-lg font-semibold text-green-800",children:"✓ PIN Verified Successfully!"})})}),u&&!m&&(0,n.jsx)("div",{className:"mb-6 animate-in fade-in slide-in-from-top-2 duration-300",children:(0,n.jsx)("div",{className:"rounded-xl bg-red-50 border-2 border-red-200 p-4 text-center",children:(0,n.jsx)("p",{className:"text-sm font-medium text-red-700",children:u})})}),f&&(0,n.jsx)("div",{className:"mb-6 text-center",children:(0,n.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full bg-blue-50 px-4 py-2",children:[(0,n.jsxs)("svg",{className:"h-5 w-5 animate-spin text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"Verifying PIN..."})]})}),m&&(0,n.jsx)("div",{className:"mb-8 animate-in fade-in slide-in-from-bottom-2 duration-500",children:(0,n.jsx)("button",{onClick:T,className:"w-full rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-4 text-lg font-bold text-white shadow-lg transition-all duration-200 hover:from-blue-700 hover:to-blue-800 hover:shadow-xl hover:scale-105 active:scale-100",children:"Continue to Orders"})}),!m&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-4 grid grid-cols-3 gap-3",children:[1,2,3,4,5,6,7,8,9].map(e=>(0,n.jsx)("button",{type:"button",onClick:()=>N(e.toString()),disabled:f||I.length>=6,className:"h-16 rounded-xl border-2 border-gray-300 bg-white text-2xl font-bold text-gray-900 shadow-md transition-all duration-150 hover:bg-gray-50 hover:border-gray-400 hover:shadow-lg active:scale-95 disabled:cursor-not-allowed disabled:opacity-40 disabled:hover:bg-white disabled:hover:shadow-md",children:e},e))}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsx)("button",{type:"button",onClick:()=>N("0"),disabled:f||I.length>=6,className:"h-16 rounded-xl border-2 border-gray-300 bg-white text-2xl font-bold text-gray-900 shadow-md transition-all duration-150 hover:bg-gray-50 hover:border-gray-400 hover:shadow-lg active:scale-95 disabled:cursor-not-allowed disabled:opacity-40 disabled:hover:bg-white disabled:hover:shadow-md",children:"0"}),(0,n.jsx)("button",{type:"button",onClick:w,disabled:f||0===I.length,className:"h-16 rounded-xl border-2 border-gray-300 bg-white text-xl font-bold text-gray-900 shadow-md transition-all duration-150 hover:bg-red-50 hover:border-red-300 hover:shadow-lg active:scale-95 disabled:cursor-not-allowed disabled:opacity-40 disabled:hover:bg-white disabled:hover:shadow-md",children:"⌫"})]})]})]})})}},533:function(e,t,r){"use strict";r.d(t,{CT:function(){return a},eg:function(){return i},NA:function(){return o}});var n,s=r(257);let a="http://localhost:8080/api".replace(/\/+$/,"")||(null===(n=s.env.NEXT_PUBLIC_API_URL)||void 0===n?void 0:n.replace(/\/+$/,""))||"http://localhost:8080/api",o=!0,i={ROLE_SUPERADMIN:"/superadmin/dashboard",ROLE_ADMIN:"/admin/dashboard",ROLE_WAITER:"/login",ROLE_KITCHEN:"/login"}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3092)}),_N_E=e.O()}]);