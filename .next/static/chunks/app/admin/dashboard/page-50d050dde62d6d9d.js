(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{5875:function(e,a,t){Promise.resolve().then(t.bind(t,6764))},6764:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var r=t(7437),s=t(2265),l=t(8734),n=t(2285),i=t(6997);let o={branch:null,staff:[],tables:[],menu:[],loading:!0,error:null};function d(){var e;let{user:a}=(0,l.a)(),t=(0,n.h)(),[d,m]=(0,s.useState)(o);(0,s.useEffect)(()=>{let e=!1,r=async()=>{if(!(null==a?void 0:a.branchId)||!a.restaurantId){m({branch:null,staff:[],tables:[],menu:[],loading:!1,error:"Your account is missing branch or restaurant assignments."});return}m(e=>({...e,loading:!0,error:null}));try{let[r,s,l,n]=await Promise.all([(0,i.aM)(t,a.branchId),(0,i.Z6)(t,a.branchId),(0,i.Xn)(t,a.restaurantId,a.branchId),(0,i.l_)(t,a.restaurantId)]);if(e)return;m({branch:r,staff:s,tables:l,menu:n,loading:!1,error:null})}catch(a){console.error("[AdminDashboard] load error",a),e||m({branch:null,staff:[],tables:[],menu:[],loading:!1,error:"Failed to load branch information."})}};return(null==a?void 0:a.role)==="ROLE_ADMIN"?r():m(o),()=>{e=!0}},[t,a]);let u=(0,s.useMemo)(()=>({staffCount:d.staff.length,tableCount:d.tables.length,activeTables:d.tables.filter(e=>e.active).length,menuCount:d.menu.length}),[d.staff,d.tables,d.menu]);return(null==a?void 0:a.role)!=="ROLE_ADMIN"?(0,r.jsx)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 px-6 py-4 text-sm text-amber-900",children:"Access restricted to Admin role."}):a.branchId&&a.restaurantId?(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("header",{className:"page-header",children:[(0,r.jsx)("h1",{className:"page-title",children:"Branch overview"}),(0,r.jsx)("p",{className:"page-subtitle",children:"Review key details for your assigned branch. All metrics are scoped to your branch only."})]}),d.error?(0,r.jsx)("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:d.error}):null,(0,r.jsxs)("section",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsx)(c,{label:"Staff members",value:u.staffCount,loading:d.loading}),(0,r.jsx)(c,{label:"Tables",value:u.tableCount,loading:d.loading}),(0,r.jsx)(c,{label:"Active tables",value:u.activeTables,loading:d.loading}),(0,r.jsx)(c,{label:"Menu items",value:u.menuCount,loading:d.loading})]}),(0,r.jsxs)("section",{className:"card",children:[(0,r.jsx)("h2",{className:"section-title",children:"Branch details"}),d.loading?(0,r.jsx)("div",{className:"skeleton h-20 w-full"}):d.branch?(0,r.jsxs)("dl",{className:"mt-4 grid gap-4 text-sm text-warm-600 sm:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Branch name"}),(0,r.jsx)("dd",{className:"mt-1 text-base text-warm-900 font-medium",children:d.branch.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Branch ID"}),(0,r.jsx)("dd",{className:"mt-1 text-base text-warm-900 font-medium",children:d.branch.id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Restaurant ID"}),(0,r.jsx)("dd",{className:"mt-1 text-base text-warm-900 font-medium",children:d.branch.restaurantId})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Assigned admin ID"}),(0,r.jsx)("dd",{className:"mt-1 text-base text-warm-900 font-medium",children:null!==(e=d.branch.adminUserId)&&void 0!==e?e:"You"})]})]}):(0,r.jsx)("p",{className:"mt-3 text-sm text-warm-500",children:"Branch data could not be loaded. Try refreshing the page."})]}),(0,r.jsxs)("section",{className:"grid gap-4 lg:grid-cols-2",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"section-title",children:"Staff"}),d.loading?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"skeleton h-10 w-full"}),(0,r.jsx)("div",{className:"skeleton h-10 w-full"})]}):0===d.staff.length?(0,r.jsx)("div",{className:"empty-state py-6",children:(0,r.jsx)("p",{className:"empty-state-description",children:"No staff registered yet."})}):(0,r.jsx)("ul",{className:"mt-3 space-y-2 text-sm text-warm-600",children:d.staff.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between rounded-lg border border-warm-100 px-3 py-2 hover:bg-warm-50 transition-colors",children:[(0,r.jsx)("span",{className:"font-medium",children:e.email}),(0,r.jsx)("span",{className:"text-xs uppercase text-warm-400 font-bold bg-warm-100 px-2 py-1 rounded",children:e.role.replace("ROLE_","")})]},e.id))})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"section-title",children:"Tables"}),d.loading?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"skeleton h-10 w-full"}),(0,r.jsx)("div",{className:"skeleton h-10 w-full"})]}):0===d.tables.length?(0,r.jsx)("div",{className:"empty-state py-6",children:(0,r.jsx)("p",{className:"empty-state-description",children:"No tables registered. Create tables to start seating guests."})}):(0,r.jsx)("ul",{className:"mt-3 space-y-2 text-sm text-warm-600",children:d.tables.map(e=>{var a,t;return(0,r.jsx)("li",{className:"flex items-center justify-between rounded-lg border border-warm-100 px-3 py-2 hover:bg-warm-50 transition-colors",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium text-warm-800",children:["Table ",null!==(a=e.tableNumber)&&void 0!==a?a:e.id]}),(0,r.jsxs)("p",{className:"text-xs text-warm-500",children:["Seats ",null!==(t=e.seatCount)&&void 0!==t?t:"N/A"," â€¢ ",(0,r.jsx)("span",{className:e.active?"text-green-600 font-medium":"text-warm-400",children:e.active?"Active":"Inactive"})]})]})},e.id)})})]})]}),(0,r.jsxs)("section",{className:"card",children:[(0,r.jsx)("h2",{className:"section-title",children:"Menu preview"}),d.loading?(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,r.jsx)("div",{className:"skeleton h-20 w-full"}),(0,r.jsx)("div",{className:"skeleton h-20 w-full"}),(0,r.jsx)("div",{className:"skeleton h-20 w-full"})]}):0===d.menu.length?(0,r.jsx)("div",{className:"empty-state py-6",children:(0,r.jsx)("p",{className:"empty-state-description",children:"No menu items available. Menu changes are managed by the SuperAdmin."})}):(0,r.jsx)("ul",{className:"mt-3 grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:d.menu.slice(0,6).map(e=>{var a;return(0,r.jsxs)("li",{className:"rounded-xl border border-warm-100 px-4 py-3 hover:shadow-sm hover:border-warm-200 transition-all bg-warm-50/50",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-warm-800",children:e.name}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,r.jsxs)("p",{className:"text-primary-600 font-bold",children:["$",((null!==(a=e.priceCents)&&void 0!==a?a:0)/100).toFixed(2)]}),(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(e.isAvailable?"bg-green-100 text-green-700":"bg-warm-200 text-warm-600"),children:e.isAvailable?"Available":"Unavailable"})]})]},e.id)})})]})]}):(0,r.jsx)("div",{className:"rounded-xl border border-red-200 bg-red-50 px-6 py-4 text-sm text-red-700",children:"Your administrator profile is missing a branch assignment. Please contact your SuperAdmin."})}function c(e){let{label:a,value:t,loading:s}=e;return(0,r.jsxs)("div",{className:"card flex flex-col justify-between h-full",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:a}),(0,r.jsx)("p",{className:"mt-2 text-3xl font-bold text-warm-900",children:s?(0,r.jsx)("span",{className:"skeleton h-8 w-16 inline-block"}):t})]})}},6997:function(e,a,t){"use strict";t.d(a,{Qf:function(){return d},T0:function(){return u},WQ:function(){return h},W_:function(){return m},Xn:function(){return c},Z6:function(){return i},aM:function(){return n},jK:function(){return o},l_:function(){return b}});var r=t(533),s=t(2911);let l=new Set(["ROLE_WAITER","ROLE_KITCHEN"]),n=async(e,a)=>{if(r.NA){console.log("[Mock] getBranch");let e=s.aE.find(e=>e.id===a);if(e)return e;throw Error("Branch not found")}let{data:t}=await e.get("/branches/".concat(a));return t},i=async(e,a)=>{if(r.NA)return console.log("[Mock] listStaff"),s.yv.filter(e=>e.branchId===a&&l.has(e.role));let{data:t}=await e.get("/users",{params:{branchId:a}});return(null!=t?t:[]).filter(e=>l.has(e.role))},o=async(e,a,t,l)=>{var n,i,o,d;if(r.NA){console.log("[Mock] createStaff");let e={id:Date.now(),email:l.email.toLowerCase(),role:l.role,restaurantId:a,branchId:t,fullName:"".concat(l.firstName||""," ").concat(l.lastName||"").trim()||"New Staff",firstName:l.firstName,lastName:l.lastName,phoneNumber:l.phoneNumber,salaryAmount:l.salaryAmount,salaryPeriod:l.salaryPeriod};return s.yv.push(e),e}let c={email:l.email.toLowerCase(),role:l.role,restaurantId:a,branchId:t};if(l.password&&(c.password=l.password),(null===(n=l.firstName)||void 0===n?void 0:n.trim())||(null===(i=l.lastName)||void 0===i?void 0:i.trim())){let e=(null===(o=l.firstName)||void 0===o?void 0:o.trim())||"",a=(null===(d=l.lastName)||void 0===d?void 0:d.trim())||"";c.fullName="".concat(e," ").concat(a).trim()}void 0!==l.phoneNumber&&null!==l.phoneNumber&&(c.phoneNumber=l.phoneNumber),void 0!==l.salaryAmount&&null!==l.salaryAmount&&(c.salaryAmount=Number(l.salaryAmount)),void 0!==l.salaryPeriod&&null!==l.salaryPeriod&&(c.salaryPeriod=l.salaryPeriod);let{data:m}=await e.post("/users",c);return m},d=async(e,a,t)=>{if(r.NA){console.log("[Mock] updateStaff");let e=s.yv.find(e=>e.email.toLowerCase()===a.toLowerCase());if(e)return t.role&&(e.role=t.role),t.firstName&&(e.firstName=t.firstName),t.lastName&&(e.lastName=t.lastName),(t.firstName||t.lastName)&&(e.fullName="".concat(t.firstName||e.firstName||""," ").concat(t.lastName||e.lastName||"").trim()),void 0!==t.phoneNumber&&(e.phoneNumber=t.phoneNumber),void 0!==t.salaryAmount&&(e.salaryAmount=t.salaryAmount),void 0!==t.salaryPeriod&&(e.salaryPeriod=t.salaryPeriod),void 0!==t.branchId&&(e.branchId=t.branchId),e;throw Error("Staff not found")}let l={};if(t.role&&(l.role=t.role),t.password&&(l.password=t.password),void 0!==t.firstName||void 0!==t.lastName){var n,i;let e=(null===(n=t.firstName)||void 0===n?void 0:n.trim())||"",a=(null===(i=t.lastName)||void 0===i?void 0:i.trim())||"";e&&(l.firstName=e),a&&(l.lastName=a),(e||a)&&(l.fullName="".concat(e," ").concat(a).trim())}void 0!==t.phoneNumber&&null!==t.phoneNumber&&(l.phoneNumber=t.phoneNumber),void 0!==t.salaryAmount&&null!==t.salaryAmount&&(l.salaryAmount=Number(t.salaryAmount)),void 0!==t.salaryPeriod&&null!==t.salaryPeriod&&(l.salaryPeriod=t.salaryPeriod),void 0!==t.branchId&&null!==t.branchId&&(l.branchId=t.branchId);let{data:o}=await e.patch("/users/".concat(encodeURIComponent(a.toLowerCase())),l);return o},c=async(e,a,t)=>{if(r.NA)return console.log("[Mock] listTables"),s.JF.filter(e=>e.branchId===t);let{data:l}=await e.get("/tables",{params:{restId:a}});return(null!=l?l:[]).filter(e=>e.branchId===t)},m=async(e,a,t,l)=>{var n,i,o,d,c,m;if(r.NA){console.log("[Mock] createTable");let e={id:Date.now(),restaurantId:a,branchId:t,name:null!==(n=l.name)&&void 0!==n?n:"New Table",tableNumber:null!==(i=l.tableNumber)&&void 0!==i?i:null,seatCount:null!==(o=l.seatCount)&&void 0!==o?o:null,active:!0,qrCode:"QR-".concat(Date.now())};return s.JF.push(e),e}let{data:u}=await e.post("/tables",{restaurantId:a,branchId:t,name:null!==(d=l.name)&&void 0!==d?d:"",tableNumber:null!==(c=l.tableNumber)&&void 0!==c?c:null,seatCount:null!==(m=l.seatCount)&&void 0!==m?m:null});return u},u=async(e,a,t)=>{var l,n,i,o;if(r.NA){console.log("[Mock] updateTable");let e=s.JF.find(e=>e.id===a);if(e)return void 0!==t.name&&(e.name=null!==(l=t.name)&&void 0!==l?l:""),void 0!==t.tableNumber&&(e.tableNumber=t.tableNumber),void 0!==t.seatCount&&(e.seatCount=t.seatCount),e;throw Error("Table not found")}let d={name:null!==(n=t.name)&&void 0!==n?n:"",tableNumber:null!==(i=t.tableNumber)&&void 0!==i?i:null,seatCount:null!==(o=t.seatCount)&&void 0!==o?o:null};void 0!==t.restaurantId&&(d.restaurantId=t.restaurantId),void 0!==t.branchId&&(d.branchId=t.branchId);let{data:c}=await e.put("/tables/".concat(a),d);return c},h=async(e,a)=>{if(r.NA){console.log("[Mock] deleteTable");let e=s.JF.findIndex(e=>e.id===a);-1!==e&&s.JF.splice(e,1);return}await e.delete("/tables/".concat(a))},b=async(e,a)=>{if(r.NA)return console.log("[Mock] listMenuItems"),s.LE.filter(e=>e.restaurantId===a);let{data:t}=await e.get("/menu/admin/all",{params:{restId:a}});return null!=t?t:[]}}},function(e){e.O(0,[301,842,971,117,744],function(){return e(e.s=5875)}),_N_E=e.O()}]);