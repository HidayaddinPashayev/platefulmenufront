(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{6182:function(e,t,s){Promise.resolve().then(s.bind(s,4714))},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},257:function(e,t,s){"use strict";var r,n;e.exports=(null==(r=s.g.process)?void 0:r.env)&&"object"==typeof(null==(n=s.g.process)?void 0:n.env)?s.g.process:s(4227)},4227:function(e){!function(){var t={229:function(e){var t,s,r,n=e.exports={};function l(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{s="function"==typeof clearTimeout?clearTimeout:a}catch(e){s=a}}();var o=[],c=!1,d=-1;function u(){c&&r&&(c=!1,r.length?o=r.concat(o):d=-1,o.length&&m())}function m(){if(!c){var e=i(u);c=!0;for(var t=o.length;t;){for(r=o,o=[];++d<t;)r&&r[d].run();d=-1,t=o.length}r=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function h(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];o.push(new x(e,t)),1!==o.length||c||i(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=h,n.addListener=h,n.once=h,n.off=h,n.removeListener=h,n.removeAllListeners=h,n.emit=h,n.prependListener=h,n.prependOnceListener=h,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},s={};function r(e){var n=s[e];if(void 0!==n)return n.exports;var l=s[e]={exports:{}},a=!0;try{t[e](l,l.exports,r),a=!1}finally{a&&delete s[e]}return l.exports}r.ab="//";var n=r(229);e.exports=n}()},4714:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var r=s(7437),n=s(2265),l=s(9376),a=s(6158);function i(e){let{menu:t,onAddToCart:s}=e,n=t.reduce((e,t)=>{let s=t.category||"Other";return e[s]||(e[s]=[]),e[s].push(t),e},{}),l=Object.keys(n).sort();return 0===t.length?(0,r.jsx)("div",{className:"rounded-lg border border-slate-200 bg-white p-8 text-center",children:(0,r.jsx)("p",{className:"text-slate-600",children:"No menu items available at this time."})}):(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Menu"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:"Select items to add to your order"})]}),l.map(e=>(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:e}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:n[e].map(e=>(0,r.jsx)(o,{item:e,onAddToCart:s},e.id))})]},e))]})}function o(e){let{item:t,onAddToCart:s}=e,n=(t.priceCents/100).toFixed(2);return(0,r.jsxs)("div",{className:"rounded-lg border bg-white p-4 shadow-sm transition hover:shadow-md ".concat(t.isAvailable?"border-slate-200 cursor-pointer":"border-slate-100 opacity-60 cursor-not-allowed"),children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-slate-900",children:t.name}),t.description&&(0,r.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:t.description})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-lg font-bold text-slate-900",children:["$",n]}),t.isAvailable?(0,r.jsx)("button",{onClick:()=>s(t),className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition hover:bg-blue-700",children:"Add"}):(0,r.jsx)("span",{className:"text-xs text-slate-500",children:"Unavailable"})]})]})}function c(e){let{items:t,total:s,onUpdateQuantity:l,onRemove:a,onPlaceOrder:i,submitting:o}=e,[c,d]=(0,n.useState)(!1);if(0===t.length&&!c)return null;let u=(s/100).toFixed(2),m=t.reduce((e,t)=>e+t.quantity,0);return(0,r.jsxs)(r.Fragment,{children:[!c&&(0,r.jsxs)("button",{onClick:()=>d(!0),className:"fixed bottom-6 right-6 z-50 flex items-center gap-2 rounded-full bg-blue-600 px-6 py-3 shadow-lg transition hover:bg-blue-700",children:[(0,r.jsxs)("span",{className:"text-sm font-semibold text-white",children:["Cart (",m,")"]}),(0,r.jsxs)("span",{className:"text-sm font-bold text-white",children:["$",u]})]}),c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40 bg-slate-900/50",onClick:()=>d(!1)}),(0,r.jsxs)("div",{className:"fixed bottom-0 right-0 z-50 flex h-[85vh] w-full max-w-md flex-col bg-white shadow-2xl sm:rounded-tl-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-200 px-6 py-4",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-slate-900",children:["Your Order (",m,")"]}),(0,r.jsxs)("button",{onClick:()=>d(!1),className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100",children:[(0,r.jsx)("span",{className:"sr-only",children:"Close"}),"\xd7"]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:0===t.length?(0,r.jsx)("div",{className:"flex h-full items-center justify-center text-center",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-slate-600",children:"Your cart is empty"}),(0,r.jsx)("button",{onClick:()=>d(!1),className:"mt-4 text-sm text-blue-600 hover:underline",children:"Browse menu"})]})}):(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>{let t=(e.menuItem.priceCents/100).toFixed(2),s=(e.menuItem.priceCents*e.quantity/100).toFixed(2);return(0,r.jsxs)("div",{className:"flex items-start gap-4 rounded-lg border border-slate-200 p-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-medium text-slate-900",children:e.menuItem.name}),(0,r.jsxs)("p",{className:"text-sm text-slate-600",children:["$",t," each"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>l(e.menuItem.id,e.quantity-1),className:"rounded-full border border-slate-300 bg-white px-2 py-1 text-sm font-medium text-slate-700 transition hover:bg-slate-50",children:"âˆ’"}),(0,r.jsx)("span",{className:"w-8 text-center text-sm font-medium text-slate-900",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>l(e.menuItem.id,e.quantity+1),className:"rounded-full border border-slate-300 bg-white px-2 py-1 text-sm font-medium text-slate-700 transition hover:bg-slate-50",children:"+"})]}),(0,r.jsx)("div",{className:"w-20 text-right",children:(0,r.jsxs)("p",{className:"font-semibold text-slate-900",children:["$",s]})}),(0,r.jsxs)("button",{onClick:()=>a(e.menuItem.id),className:"rounded-full p-1 text-red-600 transition hover:bg-red-50",children:[(0,r.jsx)("span",{className:"sr-only",children:"Remove"}),"\xd7"]})]})]},e.menuItem.id)})})}),t.length>0&&(0,r.jsxs)("div",{className:"border-t border-slate-200 bg-slate-50 px-6 py-4",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-lg font-semibold text-slate-900",children:"Total"}),(0,r.jsxs)("span",{className:"text-xl font-bold text-slate-900",children:["$",u]})]}),(0,r.jsx)("button",{onClick:i,disabled:o||0===t.length,className:"w-full rounded-lg bg-blue-600 px-4 py-3 text-sm font-semibold text-white transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",children:o?"Placing Order...":"Place Order"})]})]})]})]})}function d(){return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md rounded-lg border border-green-200 bg-green-50 p-8 text-center shadow-sm",children:[(0,r.jsx)("div",{className:"mb-4 inline-flex h-16 w-16 items-center justify-center rounded-full bg-green-100",children:(0,r.jsx)("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h1",{className:"mb-2 text-2xl font-bold text-green-900",children:"Order Placed!"}),(0,r.jsx)("p",{className:"mb-6 text-slate-600",children:"Your order has been received and is being prepared. A server will bring it to your table shortly."}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"rounded-lg bg-blue-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-blue-700",children:"Order More"})]})})}function u(){let e=(0,l.useParams)(),t=(0,l.useSearchParams)(),s=Number(e.tableId),o=Number(t.get("branchId")),[u,m]=(0,n.useState)("loading"),[x,h]=(0,n.useState)(null),[b,f]=(0,n.useState)(null),[p,g]=(0,n.useState)([]),[j,v]=(0,n.useState)([]),[N,y]=(0,n.useState)(null),[w,k]=(0,n.useState)(!0),[I,C]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!s||!o||isNaN(s)||isNaN(o)){y("Invalid table or branch ID. Please scan the QR code again."),k(!1);return}(async()=>{try{k(!0),y(null);let e=await (0,a.IR)(o,s);h(e.guestSessionId),f(e.restaurantId);let t=await (0,a.p7)(o,s);g(t),m("menu")}catch(e){console.error("[TablePage] Initialization error:",e),y((null==e?void 0:e.message)||"Failed to load menu. Please try again.")}finally{k(!1)}})()},[s,o]);let T=e=>{v(t=>t.filter(t=>t.menuItem.id!==e))},P=async()=>{if(x&&o&&s&&0!==j.length){C(!0);try{let e={guestSessionId:x,branchId:o,tableId:s,items:j.map(e=>({menuItemId:e.menuItem.id,qty:e.quantity}))};await (0,a.Sb)(e),v([]),m("success")}catch(e){console.error("[TablePage] Order error:",e),y((null==e?void 0:e.message)||"Failed to place order. Please try again.")}finally{C(!1)}}};if(w)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mb-4 inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Loading menu..."})]})});if(N&&"loading"===u)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md rounded-lg border border-red-200 bg-red-50 p-6 text-center",children:[(0,r.jsx)("h1",{className:"mb-2 text-lg font-semibold text-red-900",children:"Error"}),(0,r.jsx)("p",{className:"text-sm text-red-700",children:N})]})});if("success"===u)return(0,r.jsx)(d,{});let S=j.reduce((e,t)=>e+t.menuItem.priceCents*t.quantity,0);return(0,r.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[N&&(0,r.jsxs)("div",{className:"border-b border-red-200 bg-red-50 px-4 py-3 text-center text-sm text-red-700",children:[N,(0,r.jsx)("button",{onClick:()=>y(null),className:"ml-2 font-medium underline",children:"Dismiss"})]}),(0,r.jsx)("div",{className:"mx-auto max-w-4xl px-4 py-6",children:(0,r.jsx)(i,{menu:p,onAddToCart:e=>{e.isAvailable&&v(t=>t.find(t=>t.menuItem.id===e.id)?t.map(t=>t.menuItem.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{menuItem:e,quantity:1}])}})}),(0,r.jsx)(c,{items:j,total:S,onUpdateQuantity:(e,t)=>{if(t<=0){T(e);return}v(s=>s.map(s=>s.menuItem.id===e?{...s,quantity:t}:s))},onRemove:T,onPlaceOrder:P,submitting:I})]})}}},function(e){e.O(0,[158,971,117,744],function(){return e(e.s=6182)}),_N_E=e.O()}]);