"use strict";(()=>{var e={};e.id=603,e.ids=[603],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4676:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>f,patchFetch:()=>A,requestAsyncStorage:()=>x,routeModule:()=>h,serverHooks:()=>g,staticGenerationAsyncStorage:()=>k});var o={};s.r(o),s.d(o,{GET:()=>d});var n=s(9303),r=s(8716),a=s(670),i=s(7070),u=s(1615),l=s(7848),c=s(5456),p=s(2988);let m={"mock-token-superadmin-12345":{id:1,email:"superadmin@cozycorner.com",role:"ROLE_SUPERADMIN",restaurantId:1,branchId:null,permissions:[]},"mock-token-admin-67890":{id:2,email:"admin@downtown.cozycorner.com",role:"ROLE_ADMIN",restaurantId:1,branchId:1,permissions:[]},"mock-token-kitchen-11111":{id:3,email:"kitchen1@cozycorner.com",role:"ROLE_KITCHEN",restaurantId:1,branchId:1,permissions:[]}};async function d(){let e=u.cookies().get("token")?.value;if(!e)return i.NextResponse.json({token:null,user:null});if(l.NA){let t=m[e];if(!t){let e=i.NextResponse.json({token:null,user:null},{status:200});return e.cookies.set("token","",{httpOnly:!0,path:"/",maxAge:0}),e.cookies.set("role","",{path:"/",maxAge:0}),e}return i.NextResponse.json({token:e,user:t})}let t=await fetch(`${l.CT}/auth/me`,{headers:{Authorization:`Bearer ${e}`},cache:"no-store"}).catch(e=>{console.error("[Auth] profile fetch failed",e)});if(!t||!t.ok){let e=i.NextResponse.json({token:null,user:null},{status:200});return e.cookies.set("token","",{httpOnly:!0,path:"/",maxAge:0}),e.cookies.set("role","",{path:"/",maxAge:0}),e}let s=await t.json(),o=(0,p.a)(e),n=(0,c.kU)(s,o)??(0,c.ZP)(o)??null;if(n&&(0,c.cU)(n,o),!n){let e=i.NextResponse.json({token:null,user:null},{status:200});return e.cookies.set("token","",{httpOnly:!0,path:"/",maxAge:0}),e.cookies.set("role","",{path:"/",maxAge:0}),e}let r=i.NextResponse.json({token:e,user:n});return r.cookies.set("role",n.role,{httpOnly:!1,sameSite:"lax",secure:!0,path:"/"}),r}let h=new n.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/auth/session/route",pathname:"/api/auth/session",filename:"route",bundlePath:"app/api/auth/session/route"},resolvedPagePath:"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\api\\auth\\session\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:x,staticGenerationAsyncStorage:k,serverHooks:g}=h,f="/api/auth/session/route";function A(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:k})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),o=t.X(0,[276,972,854],()=>s(4676));module.exports=o})();