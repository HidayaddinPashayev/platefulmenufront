(()=>{var e={};e.id=665,e.ids=[665],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7028:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>c,pages:()=>d,routeModule:()=>h,tree:()=>u}),r(3272),r(5866),r(4773);var s=r(3191),a=r(8716),n=r(7922),l=r.n(n),i=r(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let u=["",{children:["(auth)",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3272)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\(auth)\\login\\page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,4773)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\ismayila\\platefulmenufront\\src\\app\\(auth)\\login\\page.tsx"],c="/(auth)/login/page",m={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(auth)/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},786:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},8667:(e,t,r)=>{Promise.resolve().then(r.bind(r,9395))},4738:(e,t,r)=>{Promise.resolve().then(r.bind(r,1439))},1439:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(326),a=r(7577),n=r(5047),l=r(4131);function i(){(0,n.useRouter)();let{login:e,user:t,loading:r}=(0,l.a)(),[i,o]=(0,a.useState)(""),[u,d]=(0,a.useState)(""),[c,m]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1),x=async t=>{t.preventDefault(),m(null),p(!0);try{await e({email:i,password:u})}catch(e){console.error(e),m(e instanceof Error?e.message:"Login failed")}finally{p(!1)}};return s.jsx("main",{className:"flex min-h-screen items-center justify-center bg-warm-50 px-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md card-elevated",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-warm-900 mb-2",children:"Plateful"}),s.jsx("p",{className:"text-warm-500",children:"Sign in to manage your restaurant"})]}),c&&(0,s.jsxs)("div",{className:"mb-6 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700 flex items-center gap-2",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 flex-shrink-0",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})}),c]}),(0,s.jsxs)("form",{className:"space-y-5",onSubmit:x,children:[(0,s.jsxs)("div",{className:"form-group",children:[s.jsx("label",{className:"label",htmlFor:"email",children:"Email Address"}),s.jsx("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"email",value:i,onChange:e=>o(e.target.value),className:"input",placeholder:"admin@cozycorner.com"})]}),(0,s.jsxs)("div",{className:"form-group",children:[s.jsx("label",{className:"label",htmlFor:"password",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",required:!0,autoComplete:"current-password",value:u,onChange:e=>d(e.target.value),className:"input",placeholder:"••••••••"})]}),s.jsx("button",{type:"submit",disabled:h,className:"w-full btn-primary btn-lg mt-2",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})]}),s.jsx("div",{className:"mt-8 pt-6 border-t border-warm-100 text-center",children:s.jsx("p",{className:"text-xs text-warm-400",children:"Protected area. Authorized personnel only."})})]})})}r(4820)},9395:(e,t,r)=>{"use strict";r.d(t,{ConditionalAuthProvider:()=>l});var s=r(326),a=r(5047),n=r(7048);function l({children:e}){let t=(0,a.usePathname)();return t?.startsWith("/kitchen/")?s.jsx(s.Fragment,{children:e}):s.jsx(n.H,{children:e})}},4131:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var s=r(7048);let a=()=>(0,s.E)()},4820:(e,t,r)=>{"use strict";r.d(t,{CT:()=>s,eg:()=>n,NA:()=>a});let s="http://localhost:8080/api".replace(/\/+$/,"")||0,a=!0,n={ROLE_SUPERADMIN:"/superadmin/dashboard",ROLE_ADMIN:"/admin/dashboard",ROLE_WAITER:"/login",ROLE_KITCHEN:"/login"}},7048:(e,t,r)=>{"use strict";r.d(t,{E:()=>d,H:()=>u});var s=r(326),a=r(7577),n=r(5047),l=r(4820);let i=(0,a.createContext)(void 0),o=e=>l.eg[e]??"/admin/dashboard";function u({children:e}){let t=(0,n.useRouter)(),[r,l]=(0,a.useState)(null),[u,d]=(0,a.useState)(null),[c,m]=(0,a.useState)(!0),h=(0,a.useCallback)(e=>{if(!e||!e.user||!e.token||"ROLE_WAITER"===e.user.role){l(null),d(null);return}l({...e.user,permissions:Array.isArray(e.user.permissions)?e.user.permissions:[]}),d(e.token)},[]),p=(0,a.useCallback)(async()=>{try{m(!0);let e=await fetch("/api/auth/session",{cache:"no-store"});if(!e.ok)throw Error("Failed to fetch session");let t=await e.json();h(t)}catch(e){console.error("[Auth] session error",e),l(null),d(null)}finally{m(!1)}},[h]),x=(0,a.useCallback)(async e=>{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(403===r.status){let e=await r.json();throw Error(e?.message??"Login restricted for this role")}if(!r.ok){let e=await r.json().catch(()=>void 0);throw Error(e?.message??"Login failed")}let s=await r.json();if(!s.user||!s.token)throw Error("Invalid login response");if("ROLE_WAITER"===s.user.role)throw Error("Login not permitted for this role.");return h(s),t.replace(o(s.user.role)),s.user},[h,t]),g=(0,a.useCallback)(async()=>{await fetch("/api/auth/logout",{method:"POST"}),l(null),d(null),t.replace("/login")},[t]),f=(0,a.useMemo)(()=>({user:r,token:u,loading:c,login:x,logout:g,refreshSession:p}),[r,u,c,x,g,p]);return s.jsx(i.Provider,{value:f,children:e})}let d=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useAuthContext must be used within AuthProvider");return e}},3272:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`C:\Users\ismayila\platefulmenufront\src\app\(auth)\login\page.tsx#default`)},4773:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>i});var s=r(9510),a=r(5384),n=r.n(a);r(5023);let l=(0,r(8570).createProxy)(String.raw`C:\Users\ismayila\platefulmenufront\src\components\ConditionalAuthProvider.tsx#ConditionalAuthProvider`),i={title:"PlatefulMenu",description:"Role-based POS management for PlatefulMenu"};function o({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:`${n().className} bg-slate-50 text-slate-900`,children:s.jsx(l,{children:e})})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,985],()=>r(7028));module.exports=s})();