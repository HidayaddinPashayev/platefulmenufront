(()=>{var e={};e.id=643,e.ids=[643],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},4597:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(8749),s(9457),s(4773),s(5866);var r=s(3191),a=s(8716),l=s(7922),n=s.n(l),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["admin",{children:["kitchen",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8749)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\admin\\kitchen\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9457)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,4773)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\ismayila\\platefulmenufront\\src\\app\\admin\\kitchen\\page.tsx"],m="/admin/kitchen/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/kitchen/page",pathname:"/admin/kitchen",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1516:(e,t,s)=>{Promise.resolve().then(s.bind(s,311))},2139:(e,t,s)=>{Promise.resolve().then(s.bind(s,5264))},311:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(326),a=s(7577),l=s(4131),n=s(3916),i=s(4820);s(3107);let o=async(e,t)=>{if(i.NA){console.log("[Mock] generateKitchenPin");let e=String(Math.floor(1e5+9e5*Math.random()));return{branchId:t,isSet:!0,lastUpdatedAt:new Date().toISOString(),maskedPin:`**${e.slice(-4)}`,pin:e}}try{let{data:s}=await e.post(`/branches/${t}/kitchen/pin/generate`);return s}catch(e){throw console.error("[generateKitchenPin] Error:",{branchId:t,status:e?.response?.status,data:e?.response?.data}),e}},d=async(e,t,s)=>{if(i.NA)return console.log("[Mock] setKitchenPin"),{branchId:t,isSet:!0,lastUpdatedAt:new Date().toISOString(),maskedPin:`**${s.slice(-4)}`};try{let{data:r}=await e.post(`/branches/${t}/kitchen/pin`,{pin:s});return r}catch(e){throw console.error("[setKitchenPin] Error:",{branchId:t,status:e?.response?.status,data:e?.response?.data}),e}};function c(){let{user:e}=(0,l.a)(),t=(0,n.h)(),s=e?.branchId??null,[i,c]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[f,g]=(0,a.useState)(""),[N,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(null),[y,P]=(0,a.useState)(!1),[k,I]=(0,a.useState)(!1),S=async()=>{if(s&&confirm("Generate a new random PIN? The current PIN will be replaced."))try{I(!0),h(null),b(null);let e=await o(t,s),r=e.pin||null;if(r){v(r);let e=`kitchenPin_branch_${s}`;localStorage.setItem(e,r)}c(e),b("New PIN generated successfully!")}catch(e){console.error("[AdminKitchen] Generate PIN error:",e),h(e?.response?.data?.message||"Failed to generate PIN. Please try again.")}finally{I(!1)}},C=async e=>{if(e.preventDefault(),s){if(6!==f.length||!/^\d{6}$/.test(f)){h("PIN must be exactly 6 digits.");return}try{P(!0),h(null),b(null);let e=await d(t,s,f);c(e),v(f);let r=`kitchenPin_branch_${s}`;localStorage.setItem(r,f),g(""),j(!1),b("PIN updated successfully!")}catch(e){console.error("[AdminKitchen] Set PIN error:",e),h(e?.response?.data?.message||"Failed to set PIN. Please try again.")}finally{P(!1)}}};return s?r.jsx("div",{className:"flex min-h-screen bg-slate-100 px-4 py-8",children:(0,r.jsxs)("div",{className:"mx-auto w-full max-w-2xl",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Kitchen Settings"}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-slate-600",children:["Manage the 6-digit PIN for kitchen device authentication (Branch #",s,")"]})]}),p&&r.jsx("div",{className:"mb-6 animate-in fade-in slide-in-from-top-2 duration-300",children:r.jsx("div",{className:"rounded-lg border border-green-200 bg-green-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("div",{className:"ml-3 flex-1",children:r.jsx("p",{className:"text-sm font-medium text-green-800",children:p})}),r.jsx("button",{onClick:()=>b(null),className:"ml-4 text-green-600 hover:text-green-800",children:"\xd7"})]})})}),u&&r.jsx("div",{className:"mb-6 animate-in fade-in slide-in-from-top-2 duration-300",children:r.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("svg",{className:"h-5 w-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("div",{className:"ml-3 flex-1",children:r.jsx("p",{className:"text-sm font-medium text-red-800",children:u})}),r.jsx("button",{onClick:()=>h(null),className:"ml-4 text-red-600 hover:text-red-800",children:"\xd7"})]})})}),(0,r.jsxs)("div",{className:"mb-6 rounded-lg border border-slate-200 bg-white p-6 shadow-sm",children:[r.jsx("h2",{className:"mb-4 text-xl font-semibold text-slate-900",children:"Current PIN Status"}),m?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsxs)("svg",{className:"h-6 w-6 animate-spin text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{className:"ml-2 text-sm text-slate-600",children:"Loading PIN information..."})]}):i?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Status:"}),r.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${i.isSet?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:i.isSet?"PIN Set":"No PIN Set"})]}),r.jsx("div",{className:"rounded-lg border-2 border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100 p-8 shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"mb-4 text-base font-semibold text-blue-900",children:"Current Kitchen PIN"}),w?r.jsx("span",{className:"inline-block font-mono text-6xl font-bold text-blue-600 tracking-wider",children:w}):(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-mono text-4xl font-bold text-slate-400",children:i.maskedPin||"••••••"}),r.jsx("p",{className:"mt-3 text-sm text-slate-500",children:"PIN not stored locally. Generate or set a new PIN to view it here permanently."})]})]})}),i.lastUpdatedAt&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Last Updated:"}),r.jsx("span",{className:"text-sm text-slate-600",children:(e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}})(i.lastUpdatedAt)})]})]}):r.jsx("p",{className:"text-sm text-slate-600",children:"Failed to load PIN information."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white p-6 shadow-sm",children:[r.jsx("h2",{className:"mb-4 text-xl font-semibold text-slate-900",children:"Generate Random PIN"}),r.jsx("p",{className:"mb-4 text-sm text-slate-600",children:"Generate a secure 6-digit random PIN. The full PIN will be shown once for you to save."}),r.jsx("button",{onClick:S,disabled:m||k,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:k?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):"Generate Random PIN"})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white p-6 shadow-sm",children:[r.jsx("h2",{className:"mb-4 text-xl font-semibold text-slate-900",children:"Set Custom PIN"}),r.jsx("p",{className:"mb-4 text-sm text-slate-600",children:"Set a custom 6-digit PIN of your choice."}),N?(0,r.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"customPin",className:"block text-sm font-medium text-slate-700",children:"6-Digit PIN"}),r.jsx("input",{id:"customPin",type:"text",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,value:f,onChange:e=>{g(e.target.value.replace(/\D/g,"").slice(0,6)),h(null)},placeholder:"000000",className:"mt-1 block w-full rounded-lg border border-slate-300 px-4 py-2 font-mono text-lg tracking-widest focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),r.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Enter exactly 6 numeric digits (0-9)"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("button",{type:"submit",disabled:y||6!==f.length,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:y?"Saving...":"Save PIN"}),r.jsx("button",{type:"button",onClick:()=>{j(!1),g(""),h(null)},disabled:y,className:"rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:"Cancel"})]})]}):r.jsx("button",{onClick:()=>{j(!0),h(null),g("")},className:"rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-50",children:"Set Custom PIN"})]})]})]})}):r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-100 px-4",children:r.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-6 py-4 text-red-700",children:"Your account is missing branch assignment. Please contact your administrator."})})}},5264:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(326),a=s(7239);function l({children:e}){return r.jsx(a.I,{allowedRoles:["ROLE_ADMIN"],children:e})}},7239:(e,t,s)=>{"use strict";s.d(t,{I:()=>u});var r=s(326),a=s(7577),l=s(5047),n=s(4131),i=s(434),o=s(2591);let d={ROLE_SUPERADMIN:[{label:"Dashboard",href:"/superadmin/dashboard"},{label:"Branches",href:"/superadmin/branches"},{label:"Admins",href:"/superadmin/admins"},{label:"Staff",href:"/superadmin/staff"}],ROLE_ADMIN:[{label:"Dashboard",href:"/admin/dashboard"},{label:"Staff",href:"/admin/staff"},{label:"Tables",href:"/admin/tables"},{label:"Menu",href:"/admin/menu"},{label:"Kitchen settings",href:"/admin/kitchen"}],ROLE_WAITER:[],ROLE_KITCHEN:[{label:"Orders",href:"/kitchen/orders"}]},c=(e,t,s=!1)=>s?e===t:e===t||e.startsWith(`${t}/`);function m({isOpen:e,onClose:t}){let{user:s,logout:a}=(0,n.a)(),m=(0,l.usePathname)();if(!s)return null;let x=d[s.role]??[];return(0,r.jsxs)(r.Fragment,{children:[e&&r.jsx("div",{className:"fixed inset-0 z-20 bg-black/50 backdrop-blur-sm md:hidden",onClick:t}),(0,r.jsxs)("aside",{className:`
          fixed top-0 left-0 z-30 h-screen w-72 flex-col bg-white border-r border-warm-200 transition-transform duration-300 ease-in-out
          md:translate-x-0 md:static
          ${e?"translate-x-0":"-translate-x-full"}
        `,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-warm-100",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs uppercase tracking-wide text-warm-400 font-bold",children:"Signed in as"}),r.jsx("p",{className:"mt-1 text-lg font-bold text-warm-900 truncate max-w-[200px]",title:s.email,children:s.email}),r.jsx("p",{className:"text-sm capitalize text-warm-500",children:s.role.replace("ROLE_","").toLowerCase()})]}),r.jsx("button",{onClick:t,className:"md:hidden p-2 text-warm-500 hover:bg-warm-100 rounded-lg",children:r.jsx(o.Z,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"px-6 py-2",children:(0,r.jsxs)("p",{className:"text-xs text-warm-400 font-medium",children:[s.restaurantName??`Restaurant #${s.restaurantId}`,s.branchId?` • Branch #${s.branchId}`:""]})}),r.jsx("nav",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-1",children:x.map(e=>{let s=c(m,e.href,e.exact);return r.jsx(i.default,{href:e.href,onClick:()=>t(),className:`
                  flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200
                  ${s?"bg-primary-50 text-primary-700 shadow-sm":"text-warm-600 hover:bg-warm-50 hover:text-warm-900"}
                `,children:e.label},e.href)})}),r.jsx("div",{className:"p-4 border-t border-warm-100",children:r.jsx("button",{type:"button",onClick:()=>a(),className:"w-full flex items-center justify-center gap-2 rounded-xl border border-warm-200 px-4 py-2.5 text-sm font-semibold text-warm-700 transition-all hover:bg-warm-50 hover:text-red-600 hover:border-red-200 active:scale-95",children:"Sign out"})})]})]})}var x=s(7477);function u({allowedRoles:e,children:t}){(0,l.useRouter)();let{user:s,loading:i}=(0,n.a)(),[o,d]=(0,a.useState)(!1);return i||!s?r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-warm-50",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[r.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary-200 border-t-primary-600"}),r.jsx("div",{className:"text-sm font-medium text-warm-600",children:"Checking session..."})]})}):e.includes(s.role)?(0,r.jsxs)("div",{className:"flex min-h-screen bg-warm-50",children:[r.jsx(m,{isOpen:o,onClose:()=>d(!1)}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 transition-all duration-300",children:[(0,r.jsxs)("header",{className:"md:hidden flex items-center justify-between bg-white border-b border-warm-200 px-4 py-3 sticky top-0 z-20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>d(!0),className:"p-2 -ml-2 text-warm-600 hover:bg-warm-100 rounded-lg transition-colors",children:r.jsx(x.Z,{className:"w-6 h-6"})}),r.jsx("span",{className:"font-bold text-warm-900",children:"Cozy Corner"})]}),r.jsx("div",{className:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-bold text-xs",children:s.email.charAt(0).toUpperCase()})]}),r.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:r.jsx("div",{className:"mx-auto max-w-7xl",children:t})})]})]}):null}},3916:(e,t,s)=>{"use strict";s.d(t,{h:()=>o});var r=s(7577),a=s(4464),l=s(4820);let n=(e,t)=>{let s=a.Z.create({baseURL:l.CT,headers:{"Content-Type":"application/json"}});return s.interceptors.request.use(t=>(e&&(t.headers=t.headers??{},t.headers.Authorization=`Bearer ${e}`),t)),s.interceptors.response.use(e=>e,async e=>(e.response?.status===401&&t&&await t(),Promise.reject(e))),s};var i=s(4131);let o=()=>{let{token:e,logout:t}=(0,i.a)();return(0,r.useMemo)(()=>n(e??void 0,()=>{t()}),[e,t])}},4131:(e,t,s)=>{"use strict";s.d(t,{a:()=>a});var r=s(7048);let a=()=>(0,r.E)()},8749:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`C:\Users\ismayila\platefulmenufront\src\app\admin\kitchen\page.tsx#default`)},9457:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`C:\Users\ismayila\platefulmenufront\src\app\admin\layout.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,985,434,160,508],()=>s(4597));module.exports=r})();