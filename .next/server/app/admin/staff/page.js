(()=>{var e={};e.id=357,e.ids=[357],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},2743:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>c,pages:()=>u,routeModule:()=>x,tree:()=>d}),s(4713),s(9457),s(4773),s(5866);var a=s(3191),l=s(8716),r=s(7922),i=s.n(r),n=s(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=["",{children:["admin",{children:["staff",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4713)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\admin\\staff\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9457)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,4773)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\ismayila\\platefulmenufront\\src\\app\\admin\\staff\\page.tsx"],c="/admin/staff/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/staff/page",pathname:"/admin/staff",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2139:(e,t,s)=>{Promise.resolve().then(s.bind(s,5264))},4981:(e,t,s)=>{Promise.resolve().then(s.bind(s,7171))},5264:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(326),l=s(7239);function r({children:e}){return a.jsx(l.I,{allowedRoles:["ROLE_ADMIN"],children:e})}},7171:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(326),l=s(7577),r=s(4131),i=s(3916),n=s(926);let o={email:"",staffType:"Waiter",firstName:"",lastName:"",phoneNumber:"",salary:"",salaryCycle:"Monthly"},d={staffType:"Waiter",firstName:"",lastName:"",phoneNumber:"",salary:"",salaryCycle:"Monthly"},u=[{label:"Waiter",value:"Waiter"},{label:"Cleaner",value:"Cleaner"}],c=[{label:"Daily",value:"Daily"},{label:"Weekly",value:"Weekly"},{label:"Monthly",value:"Monthly"}],m=new Set(["ROLE_WAITER","ROLE_KITCHEN"]);function x(){let{user:e}=(0,r.a)(),t=(0,i.h)(),[s,x]=(0,l.useState)(!1),[b,h]=(0,l.useState)(!1),[y,g]=(0,l.useState)(o),[N,j]=(0,l.useState)(d),[v,w]=(0,l.useState)(null),[C,S]=(0,l.useState)(!1),[E,q]=(0,l.useState)(!1),[A,k]=(0,l.useState)(null),[P,F]=(0,l.useState)(null),[_,L]=(0,l.useState)(null),[R,T]=(0,l.useState)(!1),[I,M]=(0,l.useState)(null),[O,W]=(0,l.useState)([]),[U,D]=(0,l.useState)(!1),H=e?.restaurantId??null,z=e?.branchId??null,G=(e,t)=>{M({message:e,type:t}),setTimeout(()=>{M(null)},5e3)},K=()=>{g(o),k(null)},Y=()=>{j(d),F(null),w(null)},$=()=>{C||(x(!1),K())},Z=e=>{let t="",s="";if(e.firstName&&e.lastName)t=e.firstName,s=e.lastName;else if(e.fullName){let a=e.fullName.trim().split(/\s+/);t=a[0]||"",s=a.slice(1).join(" ")||""}let a="ROLE_WAITER"===e.role?"Waiter":"Cleaner",l=e.salaryPeriod?e.salaryPeriod.charAt(0)+e.salaryPeriod.slice(1).toLowerCase():"Monthly";j({staffType:a,firstName:t,lastName:s,phoneNumber:e.phoneNumber||e.phone||"",salary:null!=e.salaryAmount?String(e.salaryAmount):"",salaryCycle:l}),w(e.email),h(!0)},B=()=>{E||(h(!1),Y())},Q=async e=>{if(e.preventDefault(),k(null),!H||!z){k("Restaurant ID and Branch ID are required.");return}S(!0);try{let e="Waiter"===y.staffType?"ROLE_WAITER":"ROLE_KITCHEN",s=y.salaryCycle.toUpperCase(),a=Number(parseFloat(y.salary).toFixed(2));if(isNaN(a)||a<=0)throw Error("Salary must be a positive number.");let l=y.email.trim().toLowerCase();if(!l)throw Error("Email is required.");let r=y.phoneNumber.trim();if(!r)throw Error("Phone number is required.");let i={email:l,role:e,firstName:y.firstName.trim(),lastName:y.lastName.trim(),phoneNumber:r,salaryAmount:a,salaryPeriod:s};await (0,n.jK)(t,H,z,i);try{let e=(await (0,n.Z6)(t,z)).filter(e=>m.has(e.role));W(e)}catch(e){console.error("[AdminStaff] Failed to refresh staff list",e)}S(!1),x(!1),K(),G("Staff member created successfully!","success")}catch(t){console.error("[AdminStaff] create error",t);let e="Failed to create staff member.";t?.response?.data?.message?e=t.response.data.message:t?.response?.data?.error?e=t.response.data.error:t?.message&&(e=t.message),k(e),G(e,"error"),S(!1)}},X=async e=>{if(e.preventDefault(),F(null),!v){F("No staff member selected for editing.");return}q(!0);try{let e="Waiter"===N.staffType?"ROLE_WAITER":"ROLE_KITCHEN",s=N.salaryCycle.toUpperCase(),a=Number(parseFloat(N.salary).toFixed(2));if(isNaN(a)||a<=0)throw Error("Salary must be a positive number.");let l=N.phoneNumber.trim();if(!l)throw Error("Phone number is required.");let r={role:e,firstName:N.firstName.trim(),lastName:N.lastName.trim(),phoneNumber:l,salaryAmount:a,salaryPeriod:s};await (0,n.Qf)(t,v,r);try{let e=(await (0,n.Z6)(t,z)).filter(e=>m.has(e.role));W(e)}catch(e){console.error("[AdminStaff] Failed to refresh staff list",e)}q(!1),h(!1),Y(),G("Staff member updated successfully!","success")}catch(t){console.error("[AdminStaff] update error",t);let e="Failed to update staff member.";t?.response?.data?.message?e=t.response.data.message:t?.response?.data?.error?e=t.response.data.error:t?.message&&(e=t.message),F(e),G(e,"error"),q(!1)}};return(0,a.jsxs)(a.Fragment,{children:[I&&a.jsx(p,{message:I.message,type:I.type}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Staff directory"}),(0,a.jsxs)("p",{className:"mt-2 text-sm text-slate-500",children:["Manage staff members for ",_?_.name:"your branch","."]})]}),a.jsx("button",{type:"button",onClick:()=>{K(),x(!0)},className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-700",children:"Add staff"})]}),a.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200 bg-white shadow-sm",children:U?a.jsx("div",{className:"px-6 py-8 text-center text-sm text-slate-500",children:"Loading staff members..."}):0===O.length?a.jsx("div",{className:"px-6 py-8 text-center text-sm text-slate-500",children:'No staff members found. Click "Add staff" to add your first staff member.'}):(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[a.jsx("thead",{className:"bg-slate-50",children:(0,a.jsxs)("tr",{className:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"px-6 py-3",children:"EMAIL"}),a.jsx("th",{className:"px-6 py-3",children:"FIRST NAME"}),a.jsx("th",{className:"px-6 py-3",children:"LAST NAME"}),a.jsx("th",{className:"px-6 py-3",children:"ROLE"}),a.jsx("th",{className:"px-6 py-3",children:"PHONE"}),a.jsx("th",{className:"px-6 py-3",children:"SALARY"}),a.jsx("th",{className:"px-6 py-3",children:"SALARY CYCLE"}),a.jsx("th",{className:"px-6 py-3",children:"ACTIONS"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:O.map(e=>{let t=null,s=null;if(e.firstName&&e.lastName)t=e.firstName,s=e.lastName;else if(e.fullName){let a=e.fullName.trim().split(/\s+/);t=a[0]||null,s=a.slice(1).join(" ")||null}let l=e.phone||e.phoneNumber||null,r=null!=e.salaryAmount?Number(e.salaryAmount).toFixed(2):null,i=e.salaryPeriod||null;return(0,a.jsxs)("tr",{className:"hover:bg-slate-50",children:[a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-slate-900",children:e.email}),a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-700",children:t||"—"}),a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-700",children:s||"—"}),a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-700",children:e.role.replace("ROLE_","").toUpperCase()}),a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-700",children:l||"—"}),a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-700",children:r?`$${r}`:"—"}),a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-700",children:i?i.charAt(0)+i.slice(1).toLowerCase():"—"}),a.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-slate-700",children:a.jsx("button",{type:"button",onClick:()=>Z(e),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Edit"})})]},e.id)})})]})}),a.jsx(f,{title:"Add staff",open:s,onClose:$,error:A,onSubmit:Q,footer:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:$,className:"rounded-lg border border-slate-300 px-4 py-2 text-sm font-medium text-slate-700 transition hover:bg-slate-100",disabled:C,children:"Cancel"}),a.jsx("button",{type:"submit",form:"staff-form",disabled:C,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",children:C?"Adding…":"Add staff"})]}),children:(0,a.jsxs)("form",{id:"staff-form",className:"space-y-4",onSubmit:Q,children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"email",children:["Email ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{id:"email",type:"email",required:!0,value:y.email,onChange:e=>g(t=>({...t,email:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"staff@example.com",disabled:C})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"staff-type",children:"Staff type"}),a.jsx("select",{id:"staff-type",required:!0,value:y.staffType,onChange:e=>g(t=>({...t,staffType:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:C,children:u.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"first-name",children:"First name"}),a.jsx("input",{id:"first-name",type:"text",required:!0,value:y.firstName,onChange:e=>g(t=>({...t,firstName:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter first name",disabled:C})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"last-name",children:"Last name"}),a.jsx("input",{id:"last-name",type:"text",required:!0,value:y.lastName,onChange:e=>g(t=>({...t,lastName:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter last name",disabled:C})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"phone-number",children:"Phone number"}),a.jsx("input",{id:"phone-number",type:"tel",required:!0,value:y.phoneNumber,onChange:e=>g(t=>({...t,phoneNumber:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+1234567890",disabled:C})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"salary",children:"Salary"}),a.jsx("input",{id:"salary",type:"number",required:!0,min:"0",step:"0.01",value:y.salary,onChange:e=>g(t=>({...t,salary:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",disabled:C})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"salary-cycle",children:"Salary cycle"}),a.jsx("select",{id:"salary-cycle",required:!0,value:y.salaryCycle,onChange:e=>g(t=>({...t,salaryCycle:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:C,children:c.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]})]})}),a.jsx(f,{title:"Edit staff",open:b,onClose:B,error:P,onSubmit:X,footer:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:B,className:"rounded-lg border border-slate-300 px-4 py-2 text-sm font-medium text-slate-700 transition hover:bg-slate-100",disabled:E,children:"Cancel"}),a.jsx("button",{type:"submit",form:"edit-staff-form",disabled:E,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",children:E?"Updating…":"Update staff"})]}),children:(0,a.jsxs)("form",{id:"edit-staff-form",className:"space-y-4",onSubmit:X,children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"edit-staff-type",children:"Staff type"}),a.jsx("select",{id:"edit-staff-type",required:!0,value:N.staffType,onChange:e=>j(t=>({...t,staffType:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:E,children:u.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"edit-first-name",children:"First name"}),a.jsx("input",{id:"edit-first-name",type:"text",required:!0,value:N.firstName,onChange:e=>j(t=>({...t,firstName:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter first name",disabled:E})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"edit-last-name",children:"Last name"}),a.jsx("input",{id:"edit-last-name",type:"text",required:!0,value:N.lastName,onChange:e=>j(t=>({...t,lastName:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter last name",disabled:E})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"edit-phone-number",children:"Phone number"}),a.jsx("input",{id:"edit-phone-number",type:"tel",required:!0,value:N.phoneNumber,onChange:e=>j(t=>({...t,phoneNumber:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+1234567890",disabled:E})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"edit-salary",children:"Salary"}),a.jsx("input",{id:"edit-salary",type:"number",required:!0,min:"0",step:"0.01",value:N.salary,onChange:e=>j(t=>({...t,salary:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",disabled:E})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600",htmlFor:"edit-salary-cycle",children:"Salary cycle"}),a.jsx("select",{id:"edit-salary-cycle",required:!0,value:N.salaryCycle,onChange:e=>j(t=>({...t,salaryCycle:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:E,children:c.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]})]})})]})]})}function f({title:e,open:t,onClose:s,children:l,error:r,footer:i,onSubmit:n}){return t?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 px-4 py-4",children:(0,a.jsxs)("div",{className:"relative flex flex-col w-full max-w-lg max-h-[90vh] rounded-2xl bg-white shadow-2xl overflow-hidden",children:[r&&a.jsx("div",{className:"absolute top-0 left-0 right-0 z-[9999] rounded-t-2xl bg-red-50 border-b border-red-200 px-6 py-3 text-sm text-red-700",children:r}),(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4 p-6 pb-4 flex-shrink-0",children:[a.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:e}),(0,a.jsxs)("button",{type:"button",onClick:s,className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100 hover:text-slate-700",children:[a.jsx("span",{className:"sr-only",children:"Close"}),"\xd7"]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto px-6",style:{maxHeight:"70vh"},children:l}),i&&a.jsx("div",{className:"flex-shrink-0 p-6 pt-4 border-t border-slate-200",children:i})]})}):null}function p({message:e,type:t}){return a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center pointer-events-none",children:a.jsx("div",{className:`pointer-events-auto rounded-lg px-6 py-4 shadow-2xl transition-all duration-300 ${"success"===t?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("span",{className:"text-sm font-medium",children:e})})})})}},9457:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`C:\Users\ismayila\platefulmenufront\src\app\admin\layout.tsx#default`)},4713:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`C:\Users\ismayila\platefulmenufront\src\app\admin\staff\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[276,985,434,160,508,292],()=>s(2743));module.exports=a})();