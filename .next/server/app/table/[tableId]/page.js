(()=>{var e={};e.id=238,e.ids=[238],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5774:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o}),s(3156),s(4773),s(5866);var r=s(3191),a=s(8716),l=s(7922),n=s.n(l),i=s(5231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["table",{children:["[tableId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3156)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\table\\[tableId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4773)),"C:\\Users\\ismayila\\platefulmenufront\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\ismayila\\platefulmenufront\\src\\app\\table\\[tableId]\\page.tsx"],m="/table/[tableId]/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/table/[tableId]/page",pathname:"/table/[tableId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},237:(e,t,s)=>{Promise.resolve().then(s.bind(s,3883))},3883:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(326),a=s(7577),l=s(5047),n=s(7129);function i({menu:e,onAddToCart:t}){let s=e.reduce((e,t)=>{let s=t.category||"Other";return e[s]||(e[s]=[]),e[s].push(t),e},{}),a=Object.keys(s).sort();return 0===e.length?r.jsx("div",{className:"rounded-lg border border-slate-200 bg-white p-8 text-center",children:r.jsx("p",{className:"text-slate-600",children:"No menu items available at this time."})}):(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Menu"}),r.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Select items to add to your order"})]}),a.map(e=>(0,r.jsxs)("section",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:e}),r.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:s[e].map(e=>r.jsx(d,{item:e,onAddToCart:t},e.id))})]},e))]})}function d({item:e,onAddToCart:t}){let s=(e.priceCents/100).toFixed(2);return(0,r.jsxs)("div",{className:`rounded-lg border bg-white p-4 shadow-sm transition hover:shadow-md ${e.isAvailable?"border-slate-200 cursor-pointer":"border-slate-100 opacity-60 cursor-not-allowed"}`,children:[(0,r.jsxs)("div",{className:"mb-2",children:[r.jsx("h3",{className:"font-semibold text-slate-900",children:e.name}),e.description&&r.jsx("p",{className:"mt-1 text-sm text-slate-600",children:e.description})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-lg font-bold text-slate-900",children:["$",s]}),e.isAvailable?r.jsx("button",{onClick:()=>t(e),className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition hover:bg-blue-700",children:"Add"}):r.jsx("span",{className:"text-xs text-slate-500",children:"Unavailable"})]})]})}function o({items:e,total:t,onUpdateQuantity:s,onRemove:l,onPlaceOrder:n,submitting:i}){let[d,o]=(0,a.useState)(!1);if(0===e.length&&!d)return null;let c=(t/100).toFixed(2),m=e.reduce((e,t)=>e+t.quantity,0);return(0,r.jsxs)(r.Fragment,{children:[!d&&(0,r.jsxs)("button",{onClick:()=>o(!0),className:"fixed bottom-6 right-6 z-50 flex items-center gap-2 rounded-full bg-blue-600 px-6 py-3 shadow-lg transition hover:bg-blue-700",children:[(0,r.jsxs)("span",{className:"text-sm font-semibold text-white",children:["Cart (",m,")"]}),(0,r.jsxs)("span",{className:"text-sm font-bold text-white",children:["$",c]})]}),d&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-40 bg-slate-900/50",onClick:()=>o(!1)}),(0,r.jsxs)("div",{className:"fixed bottom-0 right-0 z-50 flex h-[85vh] w-full max-w-md flex-col bg-white shadow-2xl sm:rounded-tl-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-200 px-6 py-4",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-slate-900",children:["Your Order (",m,")"]}),(0,r.jsxs)("button",{onClick:()=>o(!1),className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-100",children:[r.jsx("span",{className:"sr-only",children:"Close"}),"\xd7"]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:0===e.length?r.jsx("div",{className:"flex h-full items-center justify-center text-center",children:(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-slate-600",children:"Your cart is empty"}),r.jsx("button",{onClick:()=>o(!1),className:"mt-4 text-sm text-blue-600 hover:underline",children:"Browse menu"})]})}):r.jsx("div",{className:"space-y-4",children:e.map(e=>{let t=(e.menuItem.priceCents/100).toFixed(2),a=(e.menuItem.priceCents*e.quantity/100).toFixed(2);return(0,r.jsxs)("div",{className:"flex items-start gap-4 rounded-lg border border-slate-200 p-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-medium text-slate-900",children:e.menuItem.name}),(0,r.jsxs)("p",{className:"text-sm text-slate-600",children:["$",t," each"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>s(e.menuItem.id,e.quantity-1),className:"rounded-full border border-slate-300 bg-white px-2 py-1 text-sm font-medium text-slate-700 transition hover:bg-slate-50",children:"âˆ’"}),r.jsx("span",{className:"w-8 text-center text-sm font-medium text-slate-900",children:e.quantity}),r.jsx("button",{onClick:()=>s(e.menuItem.id,e.quantity+1),className:"rounded-full border border-slate-300 bg-white px-2 py-1 text-sm font-medium text-slate-700 transition hover:bg-slate-50",children:"+"})]}),r.jsx("div",{className:"w-20 text-right",children:(0,r.jsxs)("p",{className:"font-semibold text-slate-900",children:["$",a]})}),(0,r.jsxs)("button",{onClick:()=>l(e.menuItem.id),className:"rounded-full p-1 text-red-600 transition hover:bg-red-50",children:[r.jsx("span",{className:"sr-only",children:"Remove"}),"\xd7"]})]})]},e.menuItem.id)})})}),e.length>0&&(0,r.jsxs)("div",{className:"border-t border-slate-200 bg-slate-50 px-6 py-4",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[r.jsx("span",{className:"text-lg font-semibold text-slate-900",children:"Total"}),(0,r.jsxs)("span",{className:"text-xl font-bold text-slate-900",children:["$",c]})]}),r.jsx("button",{onClick:n,disabled:i||0===e.length,className:"w-full rounded-lg bg-blue-600 px-4 py-3 text-sm font-semibold text-white transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",children:i?"Placing Order...":"Place Order"})]})]})]})]})}function c(){return r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md rounded-lg border border-green-200 bg-green-50 p-8 text-center shadow-sm",children:[r.jsx("div",{className:"mb-4 inline-flex h-16 w-16 items-center justify-center rounded-full bg-green-100",children:r.jsx("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h1",{className:"mb-2 text-2xl font-bold text-green-900",children:"Order Placed!"}),r.jsx("p",{className:"mb-6 text-slate-600",children:"Your order has been received and is being prepared. A server will bring it to your table shortly."}),r.jsx("button",{onClick:()=>window.location.reload(),className:"rounded-lg bg-blue-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-blue-700",children:"Order More"})]})})}function m(){let e=(0,l.useParams)(),t=(0,l.useSearchParams)(),s=Number(e.tableId),d=Number(t.get("branchId")),[m,u]=(0,a.useState)("loading"),[x,h]=(0,a.useState)(null),[b,p]=(0,a.useState)(null),[g,f]=(0,a.useState)([]),[j,N]=(0,a.useState)([]),[y,v]=(0,a.useState)(null),[w,I]=(0,a.useState)(!0),[C,P]=(0,a.useState)(!1),k=e=>{N(t=>t.filter(t=>t.menuItem.id!==e))},S=async()=>{if(x&&d&&s&&0!==j.length){P(!0);try{let e={guestSessionId:x,branchId:d,tableId:s,items:j.map(e=>({menuItemId:e.menuItem.id,qty:e.quantity}))};await (0,n.Sb)(e),N([]),u("success")}catch(e){console.error("[TablePage] Order error:",e),v(e?.message||"Failed to place order. Please try again.")}finally{P(!1)}}};if(w)return r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"mb-4 inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Loading menu..."})]})});if(y&&"loading"===m)return r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md rounded-lg border border-red-200 bg-red-50 p-6 text-center",children:[r.jsx("h1",{className:"mb-2 text-lg font-semibold text-red-900",children:"Error"}),r.jsx("p",{className:"text-sm text-red-700",children:y})]})});if("success"===m)return r.jsx(c,{});let q=j.reduce((e,t)=>e+t.menuItem.priceCents*t.quantity,0);return(0,r.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[y&&(0,r.jsxs)("div",{className:"border-b border-red-200 bg-red-50 px-4 py-3 text-center text-sm text-red-700",children:[y,r.jsx("button",{onClick:()=>v(null),className:"ml-2 font-medium underline",children:"Dismiss"})]}),r.jsx("div",{className:"mx-auto max-w-4xl px-4 py-6",children:r.jsx(i,{menu:g,onAddToCart:e=>{e.isAvailable&&N(t=>t.find(t=>t.menuItem.id===e.id)?t.map(t=>t.menuItem.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{menuItem:e,quantity:1}])}})}),r.jsx(o,{items:j,total:q,onUpdateQuantity:(e,t)=>{if(t<=0){k(e);return}N(s=>s.map(s=>s.menuItem.id===e?{...s,quantity:t}:s))},onRemove:k,onPlaceOrder:S,submitting:C})]})}},7129:(e,t,s)=>{"use strict";s.d(t,{IR:()=>n,Sb:()=>i});var r=s(4820),a=s(3107);let l=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8080",n=async(e,t)=>{if(r.NA)return console.log("[Mock] startCustomerSession"),{guestSessionId:(0,a.Ho)(e,t).guestSessionId,restaurantId:a.Vu.id};let s=await fetch(`${l}/api/customer/session/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branchId:e,tableId:t})});if(!s.ok)throw Error((await s.json().catch(()=>({}))).message||`Failed to start session: ${s.statusText}`);return s.json()},i=async e=>{if(r.NA){console.log("[Mock] createCustomerOrder");let t={id:Math.floor(1e4*Math.random())+1e3,restaurantId:a.Vu.id,branchId:e.branchId,tableId:e.tableId,status:"ORDERED",items:e.items.map((e,t)=>{let s=a.LE.find(t=>t.id===e.menuItemId);return{id:t+1,menuItemId:e.menuItemId,menuItemName:s?.name||"Unknown Item",qty:e.qty,priceCents:s?.priceCents||0}}),totalCents:e.items.reduce((e,t)=>{let s=a.LE.find(e=>e.id===t.menuItemId);return e+(s?.priceCents||0)*t.qty},0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return a.KZ.push(t),t}let t=await fetch(`${l}/api/customer/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({}))).message||`Failed to create order: ${t.statusText}`);return t.json()}},3156:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`C:\Users\ismayila\platefulmenufront\src\app\table\[tableId]\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,985,508],()=>s(5774));module.exports=r})();